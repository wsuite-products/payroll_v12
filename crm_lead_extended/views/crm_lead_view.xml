<?xml version="1.0"?>
<odoo>

    <!-- CRM Lead New Quotation Button -->
    <record id="sale_crm_crm_case_form_view_oppor_inherit_wadmin_campaign" model="ir.ui.view">
        <field name="name">sale_crm.crm.case.form.view.oppor.wadmin.campaign</field>
        <field name="model">crm.lead</field>
        <field name="inherit_id" ref="sale_crm.crm_case_form_view_oppor"/>
        <field name="arch" type="xml">
            <xpath expr="//button[@name='%(sale_crm.sale_action_quotations_new)d']" position="after">
                <button name="get_pre_quotation_report_url" type="object" string="Print"/>
            </xpath>
            <xpath expr="//button[@name='%(sale_crm.sale_action_quotations_new)d']" position="attributes">
                <attribute name="name">sale_action_quotations_new</attribute>
                <attribute name="type">object</attribute>
            </xpath>
        </field>
    </record>

    <!-- CRM Lead/Campaign Inherit Form View -->
    <record id="crm_lead_view_form_inherit_wadmin_campaign" model="ir.ui.view">
        <field name="name">crm.lead.form.inherit.wadmin.campaign</field>
        <field name="model">crm.lead</field>
        <field name="inherit_id" ref="crm.crm_case_form_view_oppor"/>
        <field name="arch" type="xml">
            <field name="stage_id" position="attributes">
                 <attribute name="domain">['|', ('team_id', '=', team_id), ('team_id', '=', False), ('id', 'in', partner_stage_ids)]</attribute>
            </field>
            <xpath expr="//field[@name='phone']" position="after">
                <field name="crm_lead_type_id" options="{'no_create': True}"/>
                <field name="users_ids" widget="many2many_tags"
                       options="{'no_create_edit': True}"/>
                <field name="product_template_ids" widget="many2many_tags" invisible="1"/>
            </xpath>
            <xpath expr="//field[@name='team_id']" position="after">
                <field name="corporate_name"/>
                <field name="product_name"/>
                <field name="campaign_type"/>
                <field name="main_category"/>
                <field name="campaign_control"/>
                <field name="lead_global_config"/>
                <field name="slug"/>
                <field name="reference_name_config"/>
                <field name="pricelist_id" required="1" groups="product.group_sale_pricelist"/>
                <field name="currency_id" invisible="1"/>
                <field name="partner_stage_ids" invisible="1"/>
            </xpath>
            <xpath expr="//field[@name='tag_ids']" position="after">
                <field name="reject_message"/>
                <field name="project_id"/>
                <field name="business_category_name"/>
                <field name="status_info"/>
                <field name="cancel_message"/>
            </xpath>
            <xpath expr="//field[@name='date_deadline']" position="after">
                <field name="accepted_campiagn_date"/>
                <field name="version"/>
                <field name="campaign_redirect_state"/>
                <field name="company_id" options="{'no_create': True}" groups="base.group_multi_company"/>
                <field name="cdb_id" />
            </xpath>
            <xpath expr="//field[@name='description']" position="after">
                <group>
                    <field name="all_user_ids" widget="many2many_tags" string="All User of Lead"/>
                    <field name="add_member_user_ids" string="Add Member History">
                        <tree>
                            <field name="date"/>
                            <field name="user_ids" widget="many2many_tags"/>
                            <field name="lead_id" invisible="1"/>
                        </tree>
                    </field>
                    <field name="notification_history_ids" string="Notification History">
                        <tree>
                            <field name="event_name"/>
                            <field name="quotation_number"/>
                            <field name="approved_by"/>
                            <field name="service_link"/>
                            <field name="user_ids" widget="many2many_tags"/>
                            <field name="lead_id" invisible="1"/>
                        </tree>
                    </field>
                </group>
            </xpath>
            <xpath expr="//notebook" position="inside">
                <page string="Lead Lines">
                    <field name="crm_lead_line_ids">
                        <form string="Sales Order Lines">
                            <group>
                                <group>
                                    <field name="product_id"/>
                                    <label for="product_uom_qty" string="Ordered Quantity"/>
                                    <div>
                                        <field
                                            context="{'partner_id':parent.partner_id, 'quantity':product_uom_qty, 'uom':product_uom, 'uom_qty_change':True, 'company_id': parent.company_id}"
                                            name="product_uom_qty" class="oe_inline"/>
                                        <field name="product_uom" groups="uom.group_uom" class="oe_inline oe_no_button"
                                            force_save="1"/>
                                    </div>
                                    <field name="product_tmpl_id"/>
                                    <field name="res_supplier_id"/>
                                    <field name="order_date"/>
                                    <field name="start_date"/>
                                    <field name="description"/>
                                    <field name="hours"/>
                                    <field name="quote_type"/>
                                    <field name="profit_percentage"/>
                                    <field name="is_distribute"/>
                                    <field name="distribution"/>
                                    <field name="distribution_order_by"/>
                                    <field name="price_unit" string="Unit Price"/>
                                    <field name="price" string="Price"/>
                                    <field name="tax_id" widget="many2many_tags"/>
                                    <field name="price_subtotal" widget="monetary" groups="account.group_show_line_subtotals_tax_excluded"/>
                                    <label for="discount" groups="sale.group_discount_per_so_line"/>
                                    <div name="discount" groups="sale.group_discount_per_so_line">
                                        <field name="discount" class="oe_inline"/> %%
                                    </div>
                                    <field name="order_line_id" invisible="1"/>
                                    <field name="pre_quotation"/>
                                    <field name="quotation_number"/>
                                    <field name="outputs_dates"/>
                                    <field name="reference"/>
                                    <field name="media_config"/>
                                    <field name="task_assignee_config"/>
                                    <field name="price_update_reason"/>
                                </group>
                            </group>
                        </form>
                        <tree decoration-success="order_line_id!=False">
                            <field name="sequence" widget="handle" />
                            <field name="display_type" invisible="1"/>
                            <field
                                name="product_id" required="1"
                                force_save="1"
                                context="{
                                    'partner_id': parent.partner_id,
                                    'quantity': product_uom_qty,
                                    'uom':product_uom,
                                    'company_id': parent.company_id,
                                    'default_lst_price': price_unit,
                                    'default_description_sale': name
                                }"
                            />
                            <field name="name" widget="section_and_note_text" string="Name"/>
                            <field name="product_tmpl_id"/>
                            <field name="res_supplier_id"/>
                            <field name="order_date"/>
                            <field name="start_date"/>
                            <field name="description"/>
                            <field name="hours" attrs="{'readonly':[('product_id', '!=', False)]}" force_save="1"/>
                            <field
                                name="product_uom_qty"
                                string="Ordered Qty"
                                context="{
                                    'partner_id': parent.partner_id,
                                    'quantity': product_uom_qty,
                                    'uom': product_uom,
                                    'company_id': parent.company_id
                                }"
                            />
                            <field
                                name="product_uom"
                                force_save="1"
                                context="{'company_id': parent.company_id}"
                                groups="uom.group_uom"
                                options='{"no_open": True}'
                            />
                            <field name="pre_quotation"/>
                            <field name="quote_type"/>
                            <field name="quotation_number"/>
                            <field name="profit_percentage"/>
                            <field name="is_distribute" invisible="1"/>
                            <field name="distribution" invisible="1"/>
                            <field name="distribution_order_by" invisible="1"/>
                            <field name="price_unit" string="Unit Price"/>
                            <field name="price" string="Price"/>
                            <field
                                name="tax_id"
                                widget="many2many_tags"
                                options="{'no_create': True}"
                                domain="[('type_tax_use','=','sale'),('company_id','=',parent.company_id)]"
                            />
                            <field name="discount" groups="sale.group_discount_per_so_line"/>
                            <field name="price_subtotal" widget="monetary" groups="account.group_show_line_subtotals_tax_excluded"/>
                            <field name="currency_id" invisible="1"/>
                            <field name="order_line_id" invisible="1"/>
                        </tree>
                    </field>
                </page>
                <page string="Product Quotes">
                    <field name="product_quote_ids">
                        <tree editable="bottom">
                            <field name="product_tmp_id"/>
                            <field name="quotation_number"/>
                            <field name="request_type"/>
                            <field name="quote_type"/>
                            <field name="currency_id"/>
                            <field name="is_approval"/>
                            <field name="approved_by"/>
                            <field name="is_fee"/>
                        </tree>
                    </field>
                </page>
                <page string="History">
                    <field name="crm_lead_stage_ids">
                        <tree create="false" delete="false">
                            <field name="crm_lead_id" invisible="1"/>
                            <field name="date"/>
                            <field name="pre_stage_id"/>
                            <field name="stage_id"/>
                        </tree>
                    </field>
                </page>
                <page string="Jobs">
                    <field name="job_ids">
                        <tree editable="bottom">
                            <field name="job_name"/>
                            <field name="quotation_number"/>
                            <field name="job_type"/>
                            <field name="status"/>
                            <field name="job_res"/>
                            <field name="job_id"/>
                            <field name="media_type"/>
                            <field name="job_inputs"/>
                            <field name="lead_id" invisible="1"/>
                        </tree>
                    </field>
                </page>
                <page string="Cancel History">
                    <field name="cancel_history_ids">
                        <tree>
                            <field name="lead_id" invisible="1"/>
                            <field name="date"/>
                            <field name="message"/>
                            <field name="user_id"/>
                        </tree>
                    </field>
                </page>
            </xpath>
        </field>
    </record>

</odoo>