<?xml version="1.0"?>
<odoo>
    <record id="vendor_rfq_tree_view" model="ir.ui.view">
        <field name="name">vendor_portal_product.rfq.tree</field>
        <field name="model">vendor.rfq</field>
        <field name="arch" type="xml">
            <tree string="Vendor RFQ">
                <field name="name"/>
                <field name="product_id"/>
                <field name="qty"/>
                <field name="estimated_price"/>
                <field name="rfq_closing_date"/>
                <field name="state"/>
            </tree>
        </field>
    </record>

    <record id="vendor_rfq_tree_form" model="ir.ui.view">
        <field name="name">vendor_portal_product.rfq.form</field>
        <field name="model">vendor.rfq</field>
        <field name="arch" type="xml">
            <form string="Vendor RFQ">
                <header>
                    <button name="rfq_confirm" string="Confirm RFQ" type="object" states="draft,pending" class="btn-primary"/>
                    <button name="action_draft" states="cancel" type="object" string="Set to Draft"/>
                    <button name="rfq_pending" states="draft" type="object" string="Set to Pending"/>
                    <button name="rfq_cancel" states="in_progress" type="object" string="Cancel"/>
                    <button name="create_purchase_order" type="object" string="Create Purchase Order" class="btn-primary" attrs="{'invisible' : ['|',('order_create','=',True) , ('state', '!=', 'done')]}"/>
                    <button name="action_purchase_order" type="object" string="Purchase Order" class="btn-primary" attrs="{'invisible' : [('order_create','!=',True)]}"/>
                    <field name="state" widget="statusbar" statusbar_visible="draft,in_progress,done"/>
                    <field name="order_create" invisible="1"/>
                </header>
                <sheet>
                    <div class="oe_title">
                        <h1>
                            <field name="name" readonly="1"/>
                        </h1>
                    </div>
                    <group >
                        <group>
                            <field name="product_id" required="1" attrs="{'readonly': [('state','not in', ['draft', 'pending'])]}"/>
                            <field name="qty" required="1" attrs="{'readonly': [('state','not in', ['draft', 'pending'])]}"/>
                            <field name="product_uom" groups="uom.group_uom" options="{'no_create': True}" attrs="{'readonly': [('state','not in', ['draft', 'pending'])]}"/>
                            <field name="currency_id" invisible="1" attrs="{'readonly': [('state','not in', ['draft', 'pending'])]}"/>
                            <field name="estimated_price" attrs="{'readonly': [('state','not in', ['draft', 'pending'])]}"/>
                            <field name="estimated_del_date" attrs="{'readonly': [('state','not in', ['draft', 'pending'])]}"/>
                            <field name="report_url" widget="url"/>
                        </group>
                        <group>
                            <field name="create_date"/>
                            <field name="rfq_closing_date" attrs="{'readonly': [('state','not in', ['draft', 'pending'])]}"/>
                            <field name="pricelist_id" required="1" attrs="{'readonly': [('state','not in', ['draft', 'pending'])]}"/>
                            <field name="sale_price" attrs="{'invisible' : [('pricelist_id', '=', False)]}" readonly="1"/>
                            <field name="cost_price" attrs="{'invisible' : [('pricelist_id', '=', False)]}" readonly="1"/>
                            <field name="vendor_ids" required="1" attrs="{'readonly': [('state','not in', ['draft', 'pending'])]}" context="{'default_customer': 0, 'search_default_supplier': 1, 'default_supplier': 1}" widget="many2many_tags"/>
                            <field name="vendor_id" attrs="{'invisible' : [('is_assign_vendor', '=', False)]}"/>
                            <field name="rfq_price" invisible="1"/>
                            <field name="del_date" invisible="1"/>
                            <field name="purchase_id" invisible="1"/>
                            <field name="is_assign_vendor" attrs="{'invisible' : [('is_assign_vendor', '=', False)]}"/>
                        </group>
                    </group>
                    <notebook>
                        <page string="RFQ Details">
                            <field name="rfq_line_ids" attrs="{'readonly' : [('state', 'in', ['done', 'cancel'])]}">
                                <tree string="Suppliers">
                                    <field name="vendor_id" context="{'default_customer': 0, 'search_default_supplier': 1, 'default_supplier': 1}" on_change="check_product(parent.product_id, parent.product_tmpl_id)"/>
                                    <field name="rfq_price" widget="monetary"/>
                                    <field name="del_date"/>
                                    <field name="note"/>
                                    <field name="is_accept" invisible="1"/>
                                    <field name="is_reject" invisible="1"/>
                                    <button name="mark_done" attrs="{'column_invisible': [('parent.is_assign_vendor', '=', True)]}" string="Select Vendor" confirm="Are you sure you want to do this?" type="object" icon="fa-paper-plane text-success"/>
                                </tree>
                            </field>
                        </page>
                    </notebook>
                    <group>
                        <field name="notes"/>
                    </group>
                </sheet>
                <div class="oe_chatter">
                    <field name="message_follower_ids" widget="mail_followers"/>
                    <field name="message_ids" widget="mail_thread"/>
                </div>
            </form>
        </field>
    </record>

    <record id="vendor_rfq_rfq_search_view" model="ir.ui.view">
       <field name="name">vendor_portal_product.rfq.search</field>
       <field name="model">vendor.rfq</field>
        <field name="arch" type="xml">
            <search string="RFQ Search">
                <field name="name" string="RFQ Number"/>
                <field name="product_id"/>
            </search>
       </field>
    </record>

    <record id="vendor_rfq_action" model="ir.actions.act_window">
        <field name="name">Vendor RFQ</field>
        <field name="type">ir.actions.act_window</field>
        <field name="res_model">vendor.rfq</field>
        <field name="view_mode">tree,form</field>
        <field name="help" type="html">
          <p class="oe_view_nocontent_create">
            <!-- Add Text Here -->
          </p><p>
            <!-- More details about what a user can do with this object will be OK -->
          </p>
        </field>
    </record>

    <!-- RFQ Menu Items -->
    <menuitem id="vendor_rfq_menu_root" name="Vendor Quotation"
              parent="vendor_portal_product_menu_vendor_portal_root"
              sequence="2"/>

    <menuitem id="vendor_rfq_menu_action"
              name="Vendor RFQ"
              parent="vendor_rfq_menu_root"
              action="vendor_rfq_action"
              sequence="10"/>
</odoo>