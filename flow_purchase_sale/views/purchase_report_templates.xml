<?xml version="1.0" encoding="utf-8"?>
<odoo>
<template id="external_layout_standard_purchase">

        <div class="header">
            <div class="row" style="font-size: 14px;">
                <div class="col-5 mb4">
                    <img t-if="company.logo" t-att-src="image_data_uri(company.logo)" style="width:100px;height:100px;" alt="Logo"/>
                    <div t-field="company.partner_id"
                        t-options='{"widget": "contact", "fields": ["name", "address", "phone", "fax", "email", "website", "vat"], "no_marker": true}'
                    />
                </div>
                <div class="col-4 mb4">
                    <br/><br/>
                    <strong>ORDER OF <span t-esc="data['report_type']" /></strong>
                    <br/>
                    <br/>
                    Order No. : <span t-esc="data['No']" />
                </div>
                <div class="col-3 mb4">
                    <table width="100%">
                        <tr>
                            <td style="text-align: center;" width="50%"><strong>Report Date</strong></td>
                            <td style="text-align: center;" width="10%"><strong>:</strong></td>
                            <td><span t-esc="context_timestamp(datetime.datetime.now()).strftime('%Y/%m/%d')"/></td>
                        </tr><br/><br/>
                        <tr>
                            <td style="text-align: center;"  width="50%"><strong>Report Time</strong></td>
                            <td style="text-align: center;" width="10%"><strong>:</strong></td>
                            <td><span t-esc="context_timestamp(datetime.datetime.now()).strftime('%H:%M %p')"/></td>
                        </tr><br/>
                        <tr>
                            <td style="text-align: center;"  width="50%"><strong>Page</strong></td>
                            <td style="text-align: center;" width="10%"><strong>:</strong></td>
                            <td>
                                <span class="page"/> of <span class="topage"/>
                            </td>
                        </tr>
                    </table>
                </div>
            </div>
            <br/>
            <div class="row" style="font-size: 14px;">
                <div class="col-7 mb4">
                    <table width="100%">
                        <tr>
                            <td width="20%"><strong>Sirs:</strong></td>
                            <td><span t-esc="data['Senores']" /></td>
                        </tr>
                        <tr>
                            <td width="20%"><strong>Attention:</strong></td>
                            <td><span t-esc="data['Atencion']" /></td>
                        </tr>
                        <tr>
                            <td width="20%"><strong>Client:</strong></td>
                            <td><span t-esc="data['Cliente']" /></td>
                        </tr>
                        <tr>
                            <td width="20%"><strong>Nit Client:</strong></td>
                            <td><span t-esc="data['Nit_Cliente']" /></td>
                        </tr>
                        <tr>
                            <td width="20%"><strong>Product:</strong></td>
                            <td><span t-esc="data['Producto']" /></td>
                        </tr>
                    </table>
                </div>
                <div class="col-5 mb4">
                    <table width="100%">
                        <tr>
                            <td  width="30%"><strong>Budget No:</strong></td>
                            <td><span t-esc="data['Presupuesto_No']" /></td>
                        </tr>
                        <tr>
                            <td width="30%"><strong>Order Date:</strong></td>
                            <td><span t-esc="context_timestamp(datetime.datetime.now()).strftime('%d/%m/%Y')"/></td>
                        </tr>
                        <tr>
                            <td  width="30%"><strong>Currency:</strong></td>
                            <td><span t-esc="data['Moneda']" /></td>
                        </tr>
                    </table>
                </div>
            </div>
        </div>
    <div class="article o_report_layout_standard" style="font-size:12px;" t-att-data-oe-model="o and o._name" t-att-data-oe-id="o and o.id" t-att-data-oe-lang="o and o.env.context.get('lang')">
        <t t-call="web.address_layout"/>
        <t t-raw="0"/>
    </div>
</template>

<template id="new_external_layout_purchase">
    <t t-if="not o" t-set="o" t-value="doc"/>

    <t t-if="not company">
        <t t-if="company_id">
            <t t-set="company" t-value="company_id"/>
        </t>
        <t t-elif="o and 'company_id' in o">
            <t t-set="company" t-value="o.company_id.sudo()"/>
        </t>
        <t t-else="else">
            <t t-set="company" t-value="res_company"/>
        </t>
    </t>
    <t t-call="flow_purchase_sale.external_layout_standard_purchase"><t t-raw="0"/></t>
</template>

<template id="report_purchaseorder_document_custom">
    <t t-set="doc" t-value="doc.with_context(lang=doc.partner_id.lang)" />
    <t t-call="flow_purchase_sale.new_external_layout_purchase">
        <div class="page" style="font-size: 13px;">
            <table width="100%" style="border: 1px solid black;">
                <tr class="text-center" style="border: 1px solid black;height:20px;">
                    <td rowspan="2">
                        <strong> Reference <br/> Type of Crib <br/> System </strong>
                    </td>
                    <td rowspan="2">
                        <strong> Station <br/> Dial/Band <br/> Program </strong>
                    </td>
                    <td colspan="37" rowspan="2"></td>
                </tr>
                <tbody>
                    <t t-foreach="final_value_list" t-as="a_line">

                        <tr>
                            <td rowspan="2" colspan="2" class="text-center"><t t-esc="Number_TO_Months.get(str(a_line))"/> <br/></td>
                            <t t-foreach="months_header_data[a_line]" t-as="day">
                                &lt;td class="text-center oe_leftfit oe_rightfit" style="background-color:<t t-esc="day['color']"/>!important; font-size: 8px; min-width: 18px"&gt; <t t-esc="day['day_str']"/>&lt;/td&gt;
                            </t>
                            <t t-foreach="months_header_day[a_line]" t-as="remaining_col">
                                <td t-att-colspan="remaining_col"></td>
                            </t>
                            <td rowspan="2" class="text-center">Total <br/>Cribs </td>
                            <td rowspan="2" class="text-center">Net <br/> Value</td>
                            <td rowspan="2" class="text-center">IVA</td>
                            <td rowspan="2" class="text-center">Total</td>
                        </tr>

                        <tr class="text-center" style="border: 1px solid black;height:20px;">
                            <t t-foreach="months_header_data[a_line]" t-as="day">
                                &lt;td class="text-center oe_leftfit oe_rightfit" style="background-color:<t t-esc="day['color']"/>!important; font-size: 10px" &gt; <t t-esc="day['day']"/>&lt;/td&gt;
                            </t>
                            <t t-foreach="months_header_day[a_line]" t-as="remaining_col">
                                <td t-att-colspan="remaining_col"></td>
                            </t>
                        </tr>

                        <t t-set="Total_Total_Cunas" t-value="0"/>
                        <t t-set="Total_Valor_Neto" t-value="0"/>
                        <t t-set="Total_IVA" t-value="0"/>
                        <t t-set="Total_Total" t-value="0"/>
                        <tr t-foreach="final_value_list.get(a_line)" t-as="line" class="text-center" style="border: 1px solid black;height:20px;">
                            <t t-set="Total_Total_Cunas" t-value="Total_Total_Cunas + line.get('Total_Cunas')"/>
                            <t t-set="Total_Valor_Neto" t-value="Total_Valor_Neto + line.get('Valor_Neto')"/>
                            <t t-set="Total_IVA" t-value="Total_IVA + line.get('IVA_amount')"/>
                            <t t-set="Total_Total" t-value="Total_Total + line.get('Valor_Neto') + line.get('IVA_amount')"/>
                            <td>
                                <t t-esc="line.get('Referencia')"/> <br/>
                                <t t-esc="line.get('Tipo_de_Cuna')"/> <br/>
                                <t t-esc="line.get('Sistema')"/>
                            </td>
                            <td>
                                <t t-esc="line.get('Emisora')"/> <br/>
                                <t t-esc="line.get('Dial_Banda')"/> <br/>
                                <t t-esc="line.get('Programa')"/>
                            </td>
                            <t t-foreach="line.get('raw_list')" t-as="day">
                                <td style="border: 1px solid black;font-size: 12px; min-width: 18px"> <t t-esc="day['value']"/></td>
                            </t>
                            <t t-foreach="months_header_day[a_line]" t-as="remaining_col">
                                <td t-att-colspan="remaining_col"></td>
                            </t>
                            <td>
                                <t t-esc="line.get('Total_Cunas')"/>
                            </td>
                            <td>
                                <span t-esc="float(line.get('Valor_Neto'))" t-options='{"widget": "monetary", "display_currency": doc.currency_id}'/>
                            </td>
                            <td>
                                <span t-esc="float(line.get('IVA_amount'))" t-options='{"widget": "monetary", "display_currency": doc.currency_id}'/>
                            </td>
                            <td>
                                <span t-esc="float(line.get('Valor_Neto') + line.get('IVA_amount'))" t-options='{"widget": "monetary", "display_currency": doc.currency_id}'/>
                            </td>
                        </tr>

                        <tr class="text-center" style="border: 1px solid black;height:20px;">
                            <td></td>
                            <td></td>
                            <td colspan="31">TOTALS</td>
                            <td><t t-esc="Total_Total_Cunas"/></td>
                            <td><span t-esc="Total_Valor_Neto" t-options='{"widget": "monetary", "display_currency": doc.currency_id}'/></td>
                            <td><span t-esc="Total_IVA" t-options='{"widget": "monetary", "display_currency": doc.currency_id}'/></td>
                            <td><span t-esc="Total_Total" t-options='{"widget": "monetary", "display_currency": doc.currency_id}'/></td>
                        </tr>
                    </t>
                </tbody>
            </table>
            <br/><br/>
            <table  width="100%">
                <tr>
                    <td width="50%">_________________________________________</td>
                    <td width="50%">_________________________________________</td>
                </tr>
                <tr>
                    <td>Ivan Chaparro Navarrete</td>
                    <td> <strong> RECEIVED BY </strong> </td>
                </tr>
                <tr>
                    <td colspan="2"><strong>PLANNER</strong></td>
                </tr>
            </table>
        </div>
    </t>
</template>

<template id="report_purchaseorder_custom">
    <t t-call="web.html_container">
        <t t-foreach="docs" t-as="doc">
            <t t-call="flow_purchase_sale.report_purchaseorder_document_custom" t-lang="doc.partner_id.lang"/>
        </t>
    </t>
</template>

</odoo>
